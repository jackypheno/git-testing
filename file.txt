First edit.
An edit from upstream master.
